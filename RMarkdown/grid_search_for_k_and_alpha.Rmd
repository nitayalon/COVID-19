---
title: "Interim report"
author: "Nitay Alon"
date: "May 15, 2020"
output: html_document
---

Sweden - check after day 70, explore the data some more
France - report separately 
Italy - validate that 52 and 60 makes no difference
Germany - check after 70
Chile - Validate the diff between 60 and 70

```{r load environment libraries}
library(dplyr)
library(tidyverse)
library(plotly)
library(ggplot2)
```


```{r Germany grid search}
state <- 'Germany'
grid_search_results <- mainFunction(state,60, population_list[[state]])
K_grid <- c(grid_search_results$K_CI[1], grid_search_results$mle_K, grid_search_results$K_CI[2])
alpha_grid <- c(grid_search_results$alpha_CI[1], grid_search_results$mle_alpha, grid_search_results$alpha_CI[2])
trajectories <- lapply(1:3, function(i){predictCovidTrajectory(grid_search_results$environment_data, K_grid[i], alpha_grid[i])})
```

```{r plot Germany data}
dates <- seq(as.Date('22/01/2020',format = '%d/%m/%y'),as.Date('01/07/2020',format = '%d/%m/%y'),'day')
last_date <- as.Date('01/07/2020',format = '%d/%m/%y')
plotTrajectories(grid_search_results$environment_data,trajectories,dates,last_date,'Germany',ylim = c(0,2.1))
```

```{r Germany grid search}
state <- 'Italy'
italy_grid_search_results <- mainFunction(state,60, population_list[[state]])
italy_K_grid <- c(italy_grid_search_results$K_CI[1], italy_grid_search_results$mle_K, italy_grid_search_results$K_CI[2])
italy_alpha_grid <- c(italy_grid_search_results$alpha_CI[1], italy_grid_search_results$mle_alpha, italy_grid_search_results$alpha_CI[2])
italy_trajectories <- lapply(1:3, function(i){predictCovidTrajectory(italy_grid_search_results$environment_data, italy_K_grid[i], italy_alpha_grid[i])})
```

```{r plot Germany data}
dates <- seq(as.Date('22/01/2020',format = '%d/%m/%y'),as.Date('01/07/2020',format = '%d/%m/%y'),'day')
last_date <- as.Date('01/07/2020',format = '%d/%m/%y')
plotTrajectories(italy_grid_search_results$environment_data,italy_trajectories,dates,last_date,'Italy',ylim = c(0,3))
```

